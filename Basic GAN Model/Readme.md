# NuScenes GAN Training

This project demonstrates how to train a simple Generative Adversarial Network (GAN) using images extracted from the NuScenes Mini dataset. The GAN comprises a generator and a discriminator network implemented in PyTorch, and it includes techniques such as label smoothing, learning rate scheduling, and gradient clipping for improved training stability.

## Overview

- **Dataset**: NuScenes Mini  
  The project uses the NuScenes Mini dataset to load front camera images. A custom PyTorch `Dataset` class is provided to extract and preprocess these images.

- **Models**:  
  - **Generator**: Maps a noise vector (latent space) to an image.  
  - **Discriminator**: Distinguishes real images from those generated by the generator.

- **Training Loop**:  
  The training loop trains the discriminator on each batch, and then trains the generator every `n_critic` batches. The learning rate is scheduled to decay every 5 epochs.

## Prerequisites

- Python 3.x  
- PyTorch  
- Torchvision  
- NuScenes Devkit  
- NumPy  
- Matplotlib  
- PIL (Pillow)

## Installation

1. **Clone the Repository (if applicable):**

   ```bash
   git clone https://github.com/your-username/nuscenes-gan-training.git
   cd nuscenes-gan-training
   ```

2. **Install Required Packages:**

   Use `pip` to install the required libraries:

   ```bash
   pip install torch torchvision matplotlib pillow nuscenes-devkit
   ```

3. **Download and Extract the NuScenes Mini Dataset:**

   The code automatically downloads and extracts the dataset when run in Google Colab. If running locally, ensure that the dataset is placed in the correct directory (`./data/nuScenes`). For example, in Google Colab, the following commands are executed in the code:

   ```bash
   !wget https://www.nuscenes.org/data/v1.0-mini.tgz
   !mkdir -p /content/data/nuScenes
   !tar -xvzf v1.0-mini.tgz -C /content/data/nuScenes
   ```

## Running the Code

1. **Set Up Environment:**

   - If using Google Colab, make sure to enable GPU support.
   - Ensure that the NuScenes Mini dataset is downloaded and extracted correctly.

2. **Run the Script:**

   Simply run the Python script (or each cell in Colab) to start the training process. The script will:
   - Download and extract the NuScenes Mini dataset.
   - Initialize the NuScenes dataset using a custom `Dataset` class.
   - Create and train the Generator and Discriminator models.
   - Adjust learning rates using a scheduler.
   - Plot and display the Generator vs. Discriminator loss graph after training.

## Project Structure

```
nuscenes-gan-training/
├── README.md          # This file
├── train_gan.py       # Main script with the GAN implementation
└── requirements.txt   # (Optional) List of required packages
```

## Code Highlights

- **Custom Dataset**:  
  The `NuScenesDataset` class extracts tokens from NuScenes samples and loads the front camera images after applying transformations.

- **Model Architecture**:  
  The generator uses a series of linear layers with ReLU activations and Tanh at the output, while the discriminator uses linear layers with LeakyReLU and a Sigmoid activation.

- **Training Loop**:  
  Includes techniques like label smoothing, gradient clipping, and learning rate scheduling (using `StepLR`).

## Troubleshooting

- **FileNotFoundError**:  
  Ensure that the dataset directory exists and the NuScenes Mini dataset is correctly downloaded and extracted.

- **Loss Issues (e.g., Inf values)**:  
  Try lowering the learning rate, using gradient clipping, or verifying that data normalization is correct.

## License

This project is released under the [MIT License](LICENSE).

## Acknowledgements

- [NuScenes Dataset](https://www.nuscenes.org/)
- PyTorch and Torchvision for providing a robust deep learning framework.


